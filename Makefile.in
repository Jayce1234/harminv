CC = @HARMINV_CC@
CFLAGS = @HARMINV_CFLAGS@
CPPFLAGS = @CPPFLAGS@
DEFS = @DEFS@
LIBS = @LIBS@
LDFLAGS = @LDFLAGS@
INSTALL = @INSTALL@
prefix = @prefix@
# c.f. AC_ARG_PROGRAM autoconf docs:
transform=@program_transform_name@
@SET_MAKE@

VERSION = @VERSION@
package = harminv
distdir = $(package)-$(VERSION)

###########################################################################

OBJ_harminv = harminv-main.o harminv.o
OBJ_sines = sines.o harminv.o

###########################################################################

all: harminv sines
install: harminv-install
uninstall: harminv-uninstall

###########################################################################

harminv: $(OBJ_harminv)
	$(CC) $(CFLAGS) $(LDFLAGS) $(OBJ_harminv) $(LIBS) -o $@

sines: $(OBJ_sines)
	$(CC) $(CFLAGS) $(LDFLAGS) $(OBJ_sines) $(LIBS) -o $@

.c.o:
	$(CC) -c $(DEFS) $(CPPFLAGS) $(CFLAGS) $< -o $@

###########################################################################

harminv-install: harminv
	$(INSTALL) -d $(prefix)/bin
	$(INSTALL) -d $(prefix)/man/man1
	$(INSTALL) -m 0755 -s harminv $(prefix)/bin/`echo harminv|sed '$(transform)'`
	$(INSTALL) -m 0644 harminv.1 $(prefix)/man/man1

harminv-uninstall:
	rm -f $(prefix)/bin/harminv
	rm -f $(prefix)/man/man1/harminv.1

###########################################################################

uninstall: $(UNINSTALL_TARGETS)

dist:
	cvs export -D now -d $(distdir) $(package)
	pushd $(distdir) && autoheader && autoconf && popd
	rm -f $(distdir).tar.gz
	GZIP="--best" tar chozf $(distdir).tar.gz $(distdir)
	rm -rf $(distdir)

clean:
	rm -f $(OBJ_harminv) $(OBJ_sines) core

distclean: clean
	rm -f config.cache Makefile config.log config.status config.h harminv

maintainer-clean: distclean
	rm -f configure config.h
